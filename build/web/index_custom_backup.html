<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A Flutter web app for blind AI dating.">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="BlindAIDating">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png"/>

  <title>BlindAIDating</title>
  <link rel="manifest" href="manifest.json">

  <!-- Optional: Add custom font (if defined in pubspec.yaml and assets/fonts) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

  <script>
    // The value below is injected by flutter build, do not touch.
    var serviceWorkerVersion = null;
  </script>
</head>
<body>
  <!-- This script adds the flutter initialization JS code -->
  <!-- Moving flutter.js here and removing 'defer' to ensure it loads and defines _flutter before the app init script -->
  <script src="flutter.js"></script>

  <script>
    // Ensures that the Flutter app is initialized and displayed.
    // This script should run AFTER flutter.js has loaded and defined _flutter.
    window.addEventListener('load', function () {
      // Check if _flutter and its loader are defined before attempting to use them.
      // This adds a layer of robustness for potential timing or loading issues.
      if (typeof _flutter !== 'undefined' && _flutter.loader) {
        _flutter.loader.loadEntrypoint({
          serviceWorker: {
            serviceWorkerVersion: serviceWorkerVersion,
          }
        }).then(function (engineInitializer) {
          return engineInitializer.initializeEngine();
        }).then(function (appRunner) {
          return appRunner.runApp();
        }).catch(function(error) {
          // Catch any errors during the Flutter app's initialization
          // (This message will be visible in browser console if available)
          console.error("Error initializing Flutter app:", error);
          document.body.innerHTML = '<div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; text-align: center;"><h1>Error: Failed to load application.<br>Please try again later.</h1></div>';
        });
      } else {
        // Fallback or error indication if _flutter is not defined.
        // This might happen if flutter.js failed to load or execute correctly.
        // (This message will be visible in browser console if available)
        console.error("'_flutter' object or its 'loader' property is not defined. " +
                      "Flutter's core script (flutter.js) might have failed to load or execute properly.");
        // Display a user-friendly error message directly on the page.
        document.body.innerHTML = '<div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; text-align: center;"><h1>Error: Application assets missing or failed to load.<br>Please try again later.</h1></div>';
      }
    });
  </script>
</body>
</html>
